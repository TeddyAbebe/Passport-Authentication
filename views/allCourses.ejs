<div class="row mt-5">
  <div class="col-md-8">
    <div class="card card-body text-center" style="width: 70rem">
      <h1 class="text-center font-weight-bold">
        Hello, <strong class="text-muted"> <%= user.name %> </strong>
      </h1>

      <p class="lead">
        <a href="/User/dashboard" class="btn btn-primary btn-block mb-2"
          >Dashboard</a
        >
      </p>

      <h1>Course List</h1>

      <% if (messages && messages.length > 0) { %>
      <div
        class="alert alert-success alert-dismissible fade show"
        role="alert"
        style="color: black"
      >
        <% messages.forEach(message => { %>
        <strong><%= message.msg %></strong>
        <% }); %>
        <button
          type="button"
          class="close"
          data-dismiss="alert"
          aria-label="Close"
          style="color: red"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <% } %>

      <table class="table table-bordered">
        <thead style="border: 1px solid black">
          <tr style="border: 1px solid black">
            <th scope="col" style="border: 1px solid black">Code</th>
            <th scope="col" style="border: 1px solid black">Course Name</th>
            <th scope="col" style="border: 1px solid black">
              Course Description
            </th>
            <th scope="col" style="border: 1px solid black">Action</th>
          </tr>
        </thead>
        <tbody>
          <% courses.forEach(course => { %>
          <tr>
            <td style="border: 1px solid black"><%= course.code %></td>
            <td class="text-sm" style="border: 1px solid black">
              <%= course.name %>
            </td>
            <td class="text-sm" style="border: 1px solid black">
              <%= course.description %>
            </td>
            <td style="border: 1px solid black">
              <button
                class="btn btn-warning btn-sm"
                onclick="toggleUpdateForm('<%= course._id %>')"
              >
                <i class="fas fa-pencil-alt"></i>
              </button>
              <form
                action="/admin/Course/delete-course/<%= course._id %>?_method=DELETE"
                method="post"
                style="display: inline"
                onsubmit="return confirm('Are you sure you want to delete this course?');"
              >
                <input type="hidden" name="_method" value="DELETE" />
                <button
                  class="btn btn-danger btn-sm"
                  type="submit"
                  style="margin-left: 3rem"
                >
                  <input type="hidden" name="_method" value="DELETE" />
                  <i class="fa fa-trash" aria-hidden="true"></i>
                </button>
              </form>

              <form
                action="/admin/Course/update-courses?_method=PUT"
                method="post"
                style="display: none; align-items: center; margin-top: 10px"
                id="updateForm_<%= course._id %>"
              >
                <input
                  type="hidden"
                  name="courseId"
                  value="<%= course._id %>"
                  style="height: 1px"
                />
                <div class="form-group">
                  <label for="updateName_<%= course._id %>">Name</label>
                  <input
                    type="text"
                    class="form-control"
                    id="updateName_<%= course._id %>"
                    name="name"
                    value="<%= course.name %>"
                    required
                    style="
                      width: 12rem;
                      margin-left: 2px;
                      margin-right: 2px;
                      margin-top: -10px;
                    "
                  />
                </div>
                <div class="form-group">
                  <label for="updateDescription_<%= course._id %>"
                    >Description</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="updateDescription_<%= course._id %>"
                    name="description"
                    value="<%= course.description %>"
                    required
                    style="
                      width: 15rem;
                      margin-left: 2px;
                      margin-right: 2px;
                      margin-top: -10px;
                    "
                  />
                </div>
                <div class="form-group">
                  <label for="updateCode_<%= course._id %>">Code</label>
                  <input
                    type="text"
                    class="form-control"
                    id="updateCode_<%= course._id %>"
                    name="code"
                    value="<%= course.code %>"
                    required
                    style="
                      width: 5rem;
                      margin-left: 2px;
                      margin-right: 2px;
                      margin-top: -10px;
                    "
                  />
                </div>
                <button
                  type="submit"
                  class="btn btn-warning btn-sm"
                  style="
                    width: 2rem;
                    height: 25px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    margin-left: 0.5rem;
                  "
                >
                  <i class="fas fa-pencil-alt"></i>
                </button>
              </form>
            </td>
          </tr>
          <% }); %>
        </tbody>
      </table>
    </div>
  </div>
</div>

<script>
  // Function to toggle the visibility of the update form
  function toggleUpdateForm(courseId) {
    const updateForm = document.getElementById(`updateForm_${courseId}`);
    updateForm.style.display =
      updateForm.style.display === "none" ? "flex" : "none";
  }
</script>
